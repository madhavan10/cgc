<script src="/fullcalendar-5.6.0/lib/main.js"></script>


<div id="gcm-home-page">
    <div id="gcm-calendar">
        <div class="container-margin">
        <div class="container">
            <div class="dropdown">
                <div class="select">
                    <span>Event Type</span>
                    <i class="fa fa-chevron-left"></i>
                </div>
                <input type="hidden">
                    <ul class="dropdown-menu">
                        <li value="all">All</li>
                        <li value="festival">Festival</li>
                        <li value="competition">Competition</li>
                        <li value="workshop">Workshop/Academy</li>
                    </ul>
            </div>
        </div>
        </div>
        <!--<div id="gcm-calendar-event-filter-container">
            <select id="gcm-calendar-event-type-filter" onchange="calendarSelectEventType(this.value)">
                <option selected disabled>Event Type</option>
                <option value="all">All</option>
                <option value="festival">Festival</option>
                <option value="competition">Competition</option>
                <option value="workshop">Workshop/Academy</option>
            </select>
        </div>-->
        <div id="calendar"></div>
        
    </div>
            
    <script id="gcm-render-calendar-script">
        var cgcEvents = [];
        var cgcFestivals = [];
        var cgcCompetitions = [];
        var cgcWorkshops = [];
        var calendarElt = document.getElementById("calendar");
        var calendar = new FullCalendar.Calendar(calendarElt, {
            initialView: "dayGridMonth",
            headerToolbar: {
                left: "prev,next today",
                center: "title",
                right: "dayGridMonth, dayGridWeek"
            },
            fixedWeekCount: false
            
        });
        
        document.addEventListener('DOMContentLoaded', function() {
            var getNextDate = function (aDateString) {
                var nextDate = new Date(aDateString); 
                nextDate.setDate(nextDate.getDate() + 1);
                var months = ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"];
                var nd_month_str = months[nextDate.getMonth()];
                var nd_day = nextDate.getDate();
                var nd_day_str;
                if (nd_day < 10) {
                    nd_day_str = "0" + nd_day;
                } else {
                    nd_day_str = "" + nd_day;
                }
                var nd_year = nextDate.getFullYear();
                return nd_month_str + "/" + nd_day_str + "/" + nd_year; 
            };
            //getting events
            for(var i = 0; i < window.festivals.length; i++) {
                var thisEvent = JSON.parse(window.festivals[i]._rawJSON);
                var thisCalendarEvent = {
                    title: thisEvent.eventName,
                    start: Date.parse(thisEvent.startDate),
                    end: Date.parse(getNextDate(thisEvent.endDate)), //end-date is exclusive
                    allDay: true,
                    //temporary url
                    url: "/festivals/" + thisEvent.eventName,
                    backgroundColor: "#3788d8",
                    borderColor: "#e6c571"
                };
                cgcEvents.push(thisCalendarEvent);
                if (thisEvent.radio_button === "festival-radio-button") {
                    cgcFestivals.push(thisCalendarEvent);
                } else if (thisEvent.radio_button === "festival-competition-radio-button") {
                    cgcFestivals.push(thisCalendarEvent);
                    cgcCompetitions.push(thisCalendarEvent);
                } else if (thisEvent.radio_button === "competition-radio-button") {
                    cgcCompetitions.push(thisCalendarEvent);
                } else if (thisEvent.radio_button === "workshop-radio-button") {
                    cgcWorkshops.push(thisCalendarEvent);
                }
            }
            calendar.addEventSource(cgcEvents);
            calendar.render();
            if (window.matchMedia("(max-width: 420px)").matches) {
                calendar.setOption('height', 570);
            } 
            
            
          
            
        });
    </script>
    <script src="/js/gcm-calendar-event-filter.js"></script>
    <script src="/js/gc-selector.js"></script>
</div>
 
